<!DOCUMENT html><html>	<head>        <title>1</title>		<link rel="stylesheet" type="text/css" href="css/style.css" />        <link rel="stylesheet" type="text/css" href="js/jquery-ui.css">		<script type="text/javascript" src="js/script.js"></script>		<script type="text/javascript" src="js/jquery.js"></script>        <script type="text/javascript" src="js/jquery-ui.js"></script>	</head>		<body>		<embed class="top-ad" src="ads/1.swf" />        <div>            <table>                <tr>                    <td>                        <input type="text" id="number" class="bordered enter-number" />                    </td>                    <td>                        <button style="background: url(images/buttons/pad_10.png)" id="10" alt="" onmousedown="mouseDown(this)"                             onmouseup="mouseUp(this)" onclick="backspace()" height="91" width="111" />                    </td>                    <td>                        <img src="images/buttons/pad_11.png" id="11" alt="" onmousedown="mouseDown(this)"                             onmouseup="mouseUp(this)" onclick="clr()" height="91" width="111" />                    </td>                </tr>            </table>        </div>		<div class="bordered left-banner">        </div>		        <div class="nums" id="nums">            <table>                <tr>                    <td>                        <img src="images/buttons/pad_1.png" id="1" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181" />                    </td>                    <td>                        <img src="images/buttons/pad_2.png" id="2" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                    <td>                        <img src="images/buttons/pad_3.png" id="3" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                </tr>                <tr>                    <td>                        <img src="images/buttons/pad_4.png" id="4" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td><td>                        <img src="images/buttons/pad_5.png" id="5" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td><td width="181">                        <img src="images/buttons/pad_6.png" id="6" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                </tr>                <tr>                    <td>                        <img src="images/buttons/pad_7.png" id="7" alt="" onmousedown="mouseDown(this)"                            onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                    <td>                        <img src="images/buttons/pad_8.png" id="8" alt="" onmousedown="mouseDown(this)"                                onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                    <td>                        <img src="images/buttons/pad_9.png" id="9" alt="" onmousedown="mouseDown(this)"                                onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                </tr>                <tr>                    <td>&nbsp;</td>                    <td>                        <img src="images/buttons/pad_0.png" id="0" alt="" onmousedown="mouseDown(this)"                                onmouseup="mouseUp(this)" onclick="validateNumberEntry(this)" height="111" width="181"/>                    </td>                    <td>&nbsp;</td>                </tr>            </table>        </div>		<div class="bordered right-banner" id="Div2">                </div>        <div class="navigation">            <a href="dependent.html" class="leftBtn"><img src="ru/button_back.png" alt="Назад"/></a>            <a href="pay.html" class="rightBtn"><img src="ru/button_next.png" alt="Далее"/></a>        </div>        <div id="MyDialog" title="Выберите из списка"></div>	</body>    <script>        var properties = {allowedEntries:["92", "93", "50"], mask: "**-***-**-**", minLength: 5}; // TODO Don't forget to remove in production        var number = "";        var numberMask = [];        var asteriskMask = "";        var minLen = 0;        var maxEntryLength = 0;        var minEntryLength = 0;        var maxMaskLength = 0;        $(function() {            setProperties(properties); // TODO Don't forget to remove in production            $( "#MyDialog" ).dialog({                autoOpen: false,                height: 400,                width: 450,                modal: true            });        });        function setProperties(props) {            numberMask = props.allowedEntries;            asteriskMask = props.mask;            minLen = props.minLength;            number = asteriskMask;            minEntryLength = minAllowedEntryLength(props.allowedEntries);            maxEntryLength = maxAllowedEntryLength(props.allowedEntries);            maxMaskLength = props.mask.length;            $("#number").val(number);            var div = document.getElementById("MyDialog");//$("#MyDialog");            numberMask.forEach(function(entry){                div.innerHTML += "<input type='button' " +                        "id='"+ entry + "' style='background: mediumpurple; font-size: 72px; " +                        "margin: 10px; width: 180px;' onclick='populate(this)' value=" + entry + ">";            });        }        function populate(btn){            number = asteriskMask;            for (var i=0; i< btn.id.length; i++) {                number = number.replaceAt(getAsteriskPos(0), btn.id.charAt(i));            }            $("#number").val(number);            $("#MyDialog").dialog("close");        }        function getAsteriskPos(searchPosition) {            if (searchPosition > number.length || searchPosition < 0) return "-1";            if (number.charAt(searchPosition)=="*"){                return searchPosition;            } else {                searchPosition = getAsteriskPos(searchPosition+1);            }            return searchPosition;        }        function maxAllowedEntryLength(allowedEntries) {            var max = 0;            allowedEntries.forEach(function(entry){                if(entry.length > max){                    max = entry.length;                }            });            return max;        }        function minAllowedEntryLength(allowedEntries) {            var min = 0;            if(allowedEntries.length > 0){                min = allowedEntries[0].length;                allowedEntries.forEach(function(entry){                    if(entry.length < min){                        min = entry.length;                    }                });            }            return min;        }        function validateNumberEntry(btn){            var asteriskIndex = number.indexOf("*");            if(asteriskIndex >= 0){                if (asteriskIndex >= minEntryLength) {                    number = number.replaceAt(asteriskIndex, btn.id);                } else                if(asteriskIndex <= maxEntryLength){                    if(validatePrefix(btn.id)){                        number = number.replaceAt(asteriskIndex, btn.id);                    } else { // Invalid mask entry                        var $div = $('#MyDialog');                        $div.dialog( "open");                        $div.dialog('widget').position({                            my: "left top",                            at: "left bottom",                            of: $div                        });                    }                }            }            if(number.replace("-", "").indexOf("*") > minLen){                alert("Enabled");            }            $("#number").val(number);        }        function validatePrefix(entry) {            var val = number.substr(0, number.indexOf("*")) + entry;            for (var i=0; i < numberMask.length; i++){                if (numberMask[i].substr(0, val.length) == val) return true;            }            return false;        }        String.prototype.replaceAt=function(index, character) {            return this.substr(0, index) + character + this.substr(index+character.length);        }        function backspace() {            var match = regexLastIndexOf(number, /[0-9]/);            if(match !== -1){                number = number.replaceAt(match, "*");                $("#number").val(number);            }            if(number.replace("-", "").indexOf("*") < minLen){                alert("Disabled");            }        }        function clr() {            number = asteriskMask;            $("#number").val(number);            if(number.replace("-", "").indexOf("*") < minLen){                alert("Disabled");            }        }        function regexLastIndexOf(string, regex) {            regex = (regex.global) ? regex : new RegExp(regex.source, "g" + (regex.ignoreCase ? "i" : "") + (regex.multiLine ? "m" : ""));            var stringToWorkWith = string.substring(0, string.length + 1);            var lastIndexOf = -1;            var nextStop = 0;            while((result = regex.exec(stringToWorkWith)) != null) {                lastIndexOf = result.index;                regex.lastIndex = ++nextStop;            }            return lastIndexOf;        }    </script></html>